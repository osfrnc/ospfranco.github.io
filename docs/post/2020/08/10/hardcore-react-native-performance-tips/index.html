<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="utf-8" />
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico"/>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146785440-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-146785440-1');
</script>

  <link type="application/atom+xml" rel="alternate" href="https://ospfranco.github.io/feed.xml" title="Oscar Franco on Github" /> 
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Hardcore react-native performance tips | Oscar Franco on Github</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Hardcore react-native performance tips" />
<meta name="author" content="Oscar Franco" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Recently a friend send me a link with some react-native performance optimizations, while valuable, there was nothing new in there that I did not see before, and I actually have some cases that might complement them:" />
<meta property="og:description" content="Recently a friend send me a link with some react-native performance optimizations, while valuable, there was nothing new in there that I did not see before, and I actually have some cases that might complement them:" />
<link rel="canonical" href="https://ospfranco.github.io/post/2020/08/10/hardcore-react-native-performance-tips/" />
<meta property="og:url" content="https://ospfranco.github.io/post/2020/08/10/hardcore-react-native-performance-tips/" />
<meta property="og:site_name" content="Oscar Franco on Github" />
<meta property="og:image" content="https://ospfranco.github.io/assets/taco.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-10T15:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://ospfranco.github.io/assets/taco.png" />
<meta property="twitter:title" content="Hardcore react-native performance tips" />
<meta name="twitter:site" content="@ospfranco" />
<meta name="twitter:creator" content="@Oscar Franco" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://ospfranco.github.io/post/2020/08/10/hardcore-react-native-performance-tips/"},"url":"https://ospfranco.github.io/post/2020/08/10/hardcore-react-native-performance-tips/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ospfranco.github.io/assets/taco.png"},"name":"Oscar Franco"},"author":{"@type":"Person","name":"Oscar Franco"},"image":"https://ospfranco.github.io/assets/taco.png","headline":"Hardcore react-native performance tips","description":"Recently a friend send me a link with some react-native performance optimizations, while valuable, there was nothing new in there that I did not see before, and I actually have some cases that might complement them:","dateModified":"2020-08-10T15:00:00+02:00","datePublished":"2020-08-10T15:00:00+02:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>

  <script>hljs.initHighlightingOnLoad();</script>
</head>
<html>
  <body>
    <div class="flex justify-center pt-16 pb-4">
      <div class="w-full lg:w-2/3 xl:w-1/2 px-3">
        <div class="py-12 px-4 lg:px-0">
  <h1 class="font-semibold text-2xl">Hardcore react-native performance tips</h1>
  <div class="text-gray-500">
    August 2020
  </div>
  
  <div class="markdown mt-6">
    <p>Recently a friend send me a link with some react-native <a href="https://blog.soshace.com/performance-optimizations-for-react-native-applications/">performance optimizations</a>, while valuable, there was nothing new in there that I did not see before, and I actually have some cases that might complement them:</p>

<h2 id="1-inlining-is-more-complex-in-functional-components">1. Inlining is more complex in functional components</h2>
<p>the article mentions not to pass inline functions and moves the function declaration outside of the jsx, this was true with class components, but functional components are a different game, it doesn’t matter where in your component you declare them they will always get created every time the component renders, if you really one to have a single declared function you need to use a useRef hook:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">myCallback</span> <span class="o">=</span> <span class="nx">useRef</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// some static function</span>
<span class="p">}).</span><span class="nx">current</span>

<span class="k">return</span> <span class="p">(...)</span>
</code></pre></div></div>

<h2 id="2-hermes-has-caveats">2. Hermes… has caveats</h2>
<p>Don’t get me wrong, hermes will improve the start-up performance of your application, but… it’s a custom engine, will all the caveats of a custom engine, there are some missing parts here and there (at my current company we had to polyfill/patch date/time functions to get our time library luxon to work), it’s up to you to realize if it is worth the tradeoff</p>

<h2 id="3-flatlists-are-okish-until-they-are-not">3. flatlists are okish, until they are not</h2>
<p>FlatLists are virtualized and that is good, if you have a few hundred elements, once you start talking about thousands, then it breaks down, if you want real performance you need to use a list that re-uses each item component such as <a href="https://github.com/bolan9999/react-native-largelist">large-list</a> or some other variation that recycles views to keep performance to a maximum</p>

<h2 id="4-beware-of-images">4. Beware of images</h2>
<p>I’ve actually fallen and seen other fall into this trap over and over, just because you set an image to be hidden (doesn’t matter how, height: 0, visibility: ‘hidden’, etc), doesn’t mean there is no processing going on the background, the computer will still load the image into memory, do all the transformations and adjustments and then apply your styling, a lot of processing power is wasted, I really mean a LOT, rule of thumb is: if you don’t need it, exclude the component entirely</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="o">!!</span><span class="nx">showImage</span> <span class="o">&amp;&amp;</span> <span class="o">&lt;</span><span class="nx">Image</span> <span class="nx">source</span><span class="o">=</span><span class="p">{</span><span class="nx">myCatImage</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">}
</span></code></pre></div></div>

<h2 id="5-very-interaction-heavy-components-will-never-be-smooth-on-js">5. Very interaction heavy components will never be smooth on JS</h2>
<p>Check out <a href="https://ospfranco.github.io/post/2020/08/04/use-the-mapbox-sdk-to-render-any-tile-set/">How to trick Mapbox to render any tile set</a>, no matter how clever you think you are or how hard the JIT works for you, at some point you will hit a hard barrier, in this cases, instead of building your gesture-handler-monster it is a good idea to take a step back and see if you can integrate a more native solution into your app</p>

<h2 id="6-android-receives-no-love-even-from-google">6. Android receives no love (even from google)</h2>
<p>This has been actually the hardest hitting point for me in the past 3 years, somethings in android are just WORSE, just one example: the most painful thing I have seen so far is file uploading, let just get this out of the way, if you are trying to build an application that uploads a lot of files in RN, you are going to have a bad time, the moment you try to upload more than 1 - 2 files (or have background uploads), almost all android phones start dying, current standard is <a href="https://github.com/joltup/rn-fetch-blob">react-native-fetch-blob</a> it made the app experience miserable in my previous apps</p>

<p>There are a few other examples here (ex. react-native-camera) and there of how things can impact the performance on android, just know, you will feel the pain if your app is anything more than just lists, texts and images</p>

<h2 id="7-use-reanimated-and-lottie">7. Use Reanimated and lottie</h2>
<p>If you are doing something with animations [react-native-reanimated] is the best you can aim for, it takes time to wrap your head on how to work with the API and manipulating native values declaratively but the result it’s always buttery smooth.</p>

<p>Same goes for gifs, lower end devices will run hot and kill battery, switching to lottie for static animations has helped me in this cases before</p>

<h2 id="8-react-navigation-has-gotten-better">8. React navigation has gotten better</h2>
<p>but <a href="https://github.com/wix/react-native-navigation">react-native-navigation</a> by WIX was a lot smoother (at least when I tested it)</p>

<h2 id="9-use-a-lazy-loaded-native-storage-solution">9. Use a lazy loaded native storage solution</h2>
<p>Redux-persist and mobx-persist do the job, but if you want/need to handle thousands of items in your app and want to squeeze the last drop of performance you need to go native, using things like RxDB, WatermelonDb or Realm.js will be by far the biggest performance improvements if your app handles a lot of individual entities</p>

  </div>
</div>

<div class="border-t border-gray-200"></div>

<div class="px-4 lg:px-0">
  <div class="my-6">
  <h2 class="font-medium text-4xl py-4">Apps/Libraries</h2>
  
  <div>
    <a href="https://apps.apple.com/de/app/ci-demon/id1560355863?l=en&mt=12">
      <div class="flex w-full items-center">
        <div class="overflow-hidden py-3">
          <div class="flex">
            <div class="text-blue-500">CI Demon</div>
            <a href="https://www.producthunt.com/posts/ci-demon?utm_source=badge-featured&utm_medium=badge&utm_souce=badge-ci-demon" target="_blank"><img src="https://api.producthunt.com/widgets/embed-image/v1/featured.svg?post_id=290593&theme=light" alt="CI Demon - Continuous integration builds in your desktop. | Product Hunt" style="width: 180px; height: 30px;" width="180" height="30" /></a>
          </div>
          <div class="font-extralight text-gray-700">
            macOS menu bar app, condenses your CI deployments/builds info.
          </div>
        </div>
      </div>
    </a>
    
    <a href="https://github.com/ospfranco/link-preview-js">
      <div class="flex w-full items-center">
        <div class="overflow-hidden py-3">
          <div class="text-blue-500">Link Preview JS [⭐️ 243]</div>
          <div class="font-extralight text-gray-700">
            Typescript library to generate preview of http links (think twitter cards or pasting links into whatsapp)
          </div>
        </div>
      </div>
    </a>

    <a href="https://github.com/ospfranco/react-native-quick-sqlite">
      <div class="flex w-full items-center">
        <div class="overflow-hidden py-3">
          <div class="text-blue-500">react-native-sqlite [⭐️ 5]</div>
          <div class="font-extralight text-gray-700">
            SQLite for react-native (with JSI bindings), the fastest sqlite library for react-native.
          </div>
        </div>
      </div>
    </a>

    <a href="https://github.com/ospfranco/react-native-macos-menubar-template">
      <div class="flex w-full items-center">
        <div class="overflow-hidden py-3">
          <div class="text-blue-500">react-native-macos-menubar-template [⭐️ 72]</div>
          <div class="font-extralight text-gray-700">
            A template to create a macOS menubar app using react-native, companion article is in this blog
          </div>
        </div>
      </div>
    </a>

    <a href="https://github.com/ospfranco/gh-jester">
      <div class="flex w-full items-center">
        <div class=" overflow-hidden py-3">

            <div class="text-blue-500">GH Jester</div>
            <div class="font-extralight text-gray-700">
              Github action that posts your jest test results into PRs and commits
            </div>  
        </div>
      </div>
    </a>

    <a href="https://apps.apple.com/de/app/tp-latino/id1483823093">
      <div class="flex w-full items-center">
        <div class=" overflow-hidden py-3">
            <div class="text-blue-500">TP Latino</div>
            <div class="font-extralight text-gray-700">
              Mobile app to practice for Flight Exams in South-America
            </div>  
        </div>
      </div>
    </a>
  </div>
</div>

</div>
      </div>

    </div>

    <nav class="header border-b bg-white fixed w-full justify-center flex" style="top: 0;">
      <div class="flex items-center justify-center flex-wrap py-4 w-full lg:w-2/3 xl:w-1/2 px-3">
        <a
          class="flex items-center flex-1"
          href="/"
        >
          <!-- <img src="/assets/profile.webp" class="h-12 w-12 rounded-full mr-3"/> -->
          <span class="font-normal">Oscar Franco</span>
        </a>
        <a
          class="text-blue-500 rounded px-4"
          href="https://twitter.com/ospfranco"
        >
          <img src="/assets/twitter.png" class="h-8">
        </a>
        <a
          class="text-blue-500 rounded px-4"
          href="https://github.com/ospfranco"
        >
        <img src="/assets/github.png" class="h-8">
        </a>
      </div>
    </nav>

  </body>
</html>
