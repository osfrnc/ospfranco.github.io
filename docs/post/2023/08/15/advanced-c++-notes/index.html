<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="utf-8" />
  <link
    rel="shortcut icon"
    type="image/x-icon"
    href="/assets/favicon.ico"
  />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Advanced C++ notes | Oscar Franco</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Advanced C++ notes" />
<meta name="author" content="Oscar Franco" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Noteworthy Types" />
<meta property="og:description" content="Noteworthy Types" />
<link rel="canonical" href="https://ospfranco.com/post/2023/08/15/advanced-c++-notes/" />
<meta property="og:url" content="https://ospfranco.com/post/2023/08/15/advanced-c++-notes/" />
<meta property="og:site_name" content="Oscar Franco" />
<meta property="og:image" content="https://ospfranco.com/assets/profile.JPG" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-15T15:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://ospfranco.com/assets/profile.JPG" />
<meta property="twitter:title" content="Advanced C++ notes" />
<meta name="twitter:site" content="@ospfranco" />
<meta name="twitter:creator" content="@Oscar Franco" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Oscar Franco"},"dateModified":"2023-08-15T15:00:00+02:00","datePublished":"2023-08-15T15:00:00+02:00","description":"Noteworthy Types","headline":"Advanced C++ notes","image":"https://ospfranco.com/assets/profile.JPG","mainEntityOfPage":{"@type":"WebPage","@id":"https://ospfranco.com/post/2023/08/15/advanced-c++-notes/"},"url":"https://ospfranco.com/post/2023/08/15/advanced-c++-notes/"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/inter.css" />
</head>

<html>
  <header
  class="w-full flex justify-center pt-4 pb-4 bg-white dark:bg-black fixed top-0 border-b border-gray-100 dark:border-neutral-800"
>
  <div class="w-full max-w-3xl flex items-center gap-2 px-4">
    <a href="/" class="font-semibold flex-1 text-black dark:text-white">Oscar Franco</a>

    <div class="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
    <a href="mailto:ospfranco@gmail.com"
    target="_blank" class="text-sm">
      Available for freelance work
    </a>
  </div>
</header>

<body class="flex flex-col items-center">
  <div class="px-4 pt-24 min-h-screen xl:max-w-3xl w-full">
    <div class="xl:mx-auto flex flex-col">
      <h1 class="text-black dark:text-white text-xl sm:text-4xl font-semibold">
        Advanced C++ notes
      </h1>

      <p class="mt-2 font-semibold">
        August 2023
      </p>

      <div class="pt-4 pb-20 markdown"><h1 id="noteworthy-types">Noteworthy Types</h1>

<p><code class="language-plaintext highlighter-rouge">uint8_t</code> = <code class="language-plaintext highlighter-rouge">byte</code> = a type of unsigned integer of length 8 bits</p>

<h1 id="references">References</h1>

<h2 id="printf">Printf</h2>

<p><code class="language-plaintext highlighter-rouge">printf</code> is legacy C, fairly type unsafe, <code class="language-plaintext highlighter-rouge">cout</code> seems to be accepted but android logging does not use it.</p>

<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8f53b05-b015-4ada-b275-db5407f1b41c/Screenshot_000064.png" alt="Screenshot 000064.png" /></p>

<blockquote>
  <p>üí° printing a <code class="language-plaintext highlighter-rouge">size_t</code> is done via <code class="language-plaintext highlighter-rouge">printf(‚Äù%zu‚Äù, sizeVar)</code></p>
</blockquote>

<h2 id="define-pre-processors">DEFINE pre-processors</h2>

<p>In various C code, I see constants defined like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#define T 100
</code></pre></div></div>

<p>Whereas in C++ examples, it is almost always:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const int T = 100;
</code></pre></div></div>

<p><strong>THEY ARE BAD PRACTICE IN C++</strong></p>

<p>because all macros (which are what¬†<code class="language-plaintext highlighter-rouge">#define</code>s define) are in a single namespace and they take effect everywhere. Variables, including¬†<code class="language-plaintext highlighter-rouge">const</code>-qualified variables, can be encapsulated in classes and namespaces.</p>

<p>Macros are used in C because in C, a¬†<code class="language-plaintext highlighter-rouge">const</code>-qualified variable is not actually a constant, it is just a variable that cannot be modified. A¬†<code class="language-plaintext highlighter-rouge">const</code>-qualified variable cannot appear in a constant expression, so it can‚Äôt be used as an array size, for example.</p>

<p>In C++, a¬†<code class="language-plaintext highlighter-rouge">const</code>-qualified object that is initialized with a constant expression (like¬†<code class="language-plaintext highlighter-rouge">const int x = 5 * 2;</code>)¬†<em>is</em>¬†a constant and can be used in a constant expression, so you can and should use them.</p>

<h1 id="libraries">Libraries</h1>

<p>After your code is compiled to a static lib (<code class="language-plaintext highlighter-rouge">.a</code> on macOS and <code class="language-plaintext highlighter-rouge">.so</code> on linux)</p>

<p>One useful tool is <code class="language-plaintext highlighter-rouge">nm</code>. Displays the symbol label inside of your so file, which is useful for debugging any missing symbols.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">nm</span> <span class="o">-</span><span class="nx">gDC</span> <span class="nx">myLibrary</span><span class="p">.</span><span class="nx">so</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">-g</code> Displays only global (external) symbols</p>

<p>Each symbol name is preceded by its value, followed by the following description character:</p>

<table>
  <thead>
    <tr>
      <th>U</th>
      <th>undefined</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>absolute</td>
    </tr>
    <tr>
      <td>T</td>
      <td>text section symbol</td>
    </tr>
    <tr>
      <td>D</td>
      <td>data selection symbol</td>
    </tr>
    <tr>
      <td>B</td>
      <td>bss section symbol</td>
    </tr>
    <tr>
      <td>C</td>
      <td>common symbol</td>
    </tr>
    <tr>
      <td>-</td>
      <td>Debugger symbol entries (only with -a)</td>
    </tr>
    <tr>
      <td>S</td>
      <td>Symbol in a section other than those above(???)</td>
    </tr>
    <tr>
      <td>I</td>
      <td>indirect symbol</td>
    </tr>
  </tbody>
</table>

<p>If the symbol is local (non-external), the symbol‚Äôs type is instead represented by the corresponding lower case letter. A lowercase <code class="language-plaintext highlighter-rouge">u</code> in a dynamic shared library indicates an undefined reference to a private external in another module in the same library.</p>

<p>If the symbol is a Objective-C method, the symbol name is <code class="language-plaintext highlighter-rouge">¬±[Class_name(category_name) method:name:]</code>, where <code class="language-plaintext highlighter-rouge">+</code> is for class methods, <code class="language-plaintext highlighter-rouge">-</code> is for instance
methods, and (category_name) is present only when the method is in a category.</p>

<h1 id="advanced-pointers">Advanced pointers</h1>

<h2 id="unique-pointer">Unique pointer</h2>

<p>Help with memory management. They guarantee they delete their object if they are destructed. They follow ‚ÄúResource Acquisition Is Initialization‚Äù (RAII) rule.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">unique_ptr</span><span class="o">&lt;</span><span class="nx">int</span><span class="o">&gt;</span> <span class="nx">p</span><span class="p">(</span><span class="k">new</span> <span class="nx">int</span><span class="p">);</span>
<span class="c1">// p &lt;--------&gt;  object</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">p</code> owns the object and the object has only one owner, <code class="language-plaintext highlighter-rouge">p</code>. A unique pointer cannot be copied or passed by value. However, the ownership of its object can be transferred.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">auto</span> <span class="nx">q</span> <span class="o">=</span> <span class="nx">make_unique</span><span class="o">&lt;</span><span class="nx">int</span><span class="o">&gt;</span><span class="p">();</span> <span class="c1">// q created with an int object on the heap</span>
<span class="nx">auto</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">move</span><span class="p">(</span><span class="nx">q</span><span class="p">);</span> <span class="c1">// p owns the q's object, q lost it (null pointer).</span>
</code></pre></div></div>

<p>Here is a more complete example</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="nx">include</span><span class="o">&lt;</span><span class="nx">iostream</span><span class="o">&gt;</span>
<span class="err">#</span><span class="nx">include</span><span class="o">&lt;</span><span class="nx">memory</span><span class="o">&gt;</span>
<span class="nx">using</span> <span class="nx">namespace</span> <span class="nx">std</span><span class="p">;</span>

<span class="nx">struct</span> <span class="nx">A</span><span class="p">{</span>
    <span class="o">~</span><span class="nx">A</span><span class="p">(){</span><span class="nx">cout</span><span class="o">&lt;&lt;</span><span class="dl">"</span><span class="s2">Deleted.</span><span class="dl">"</span><span class="p">;}</span>
<span class="p">};</span>

<span class="k">void</span> <span class="nx">PassIn</span><span class="p">(</span><span class="nx">std</span><span class="p">::</span><span class="nx">unique_ptr</span><span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">cout</span><span class="o">&lt;&lt;</span> <span class="dl">"</span><span class="s2">Pointer received.</span><span class="dl">"</span><span class="o">&lt;&lt;</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// a and its object are deleted.</span>

<span class="nx">int</span> <span class="nx">main</span><span class="p">(){</span>
    
    <span class="nx">auto</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">make_unique</span><span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="nx">PassIn</span><span class="p">(</span><span class="nx">move</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="c1">// Pointer received.</span>
    <span class="p">;</span> <span class="c1">// Deleted.</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">x</span><span class="p">)</span> <span class="nx">cout</span><span class="o">&lt;&lt;</span> <span class="dl">"</span><span class="s2">x is empty.</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// true: x is empty.</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="shared-pointer">Shared pointer</h2>

<p>Multiple instance pointer, once all the shared pointers are destructed then the object gets deleted. Passing by value creates a new shared pointer allocation (e.g. count 2)</p>

<h2 id="weak-pointer">Weak pointer</h2>

<p>A weak pointer is a smart pointer that does not take ownership of an object but act as an observer. It‚Äôs used to observe the object of a shared pointer. It does not participate in reference counting. Weak pointers are mainly used to break circular dependencies.</p>

<h1 id="type-aliases">Type Aliases</h1>

<p>On C++ 11, the keyword is <code class="language-plaintext highlighter-rouge">using</code></p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// C++11</span>
<span class="nx">using</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">long</span><span class="p">;</span>

<span class="c1">// C++03 equivalent:</span>
<span class="nx">typedef</span> <span class="nx">long</span> <span class="nx">counter</span><span class="p">;</span>
</code></pre></div></div>

<h1 id="object-initialization">Object initialization</h1>

<p>There is only one way to initialize class consts or reference members, using the the <code class="language-plaintext highlighter-rouge">initialization list</code> syntax. It initializes the variables of an instance before the body of the constructor is called</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Demo</span>
<span class="p">{</span>
    <span class="nx">Demo</span><span class="p">(</span><span class="nx">int</span><span class="o">&amp;</span> <span class="nx">val</span><span class="p">)</span> <span class="p">:</span> <span class="nx">m_val</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span>
     <span class="p">{</span>
     <span class="p">}</span>
<span class="nl">private</span><span class="p">:</span>
    <span class="kd">const</span> <span class="nx">int</span><span class="o">&amp;</span> <span class="nx">m_val</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="destructor">Destructor</h2>

<p>You can execute code after an object has been destructured</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// dispatch_queue.h</span>
<span class="k">class</span> <span class="nc">dispatch_queue</span> <span class="p">{</span>

<span class="nl">public:</span>
<span class="c1">// Explicit constructor (does not allow for argument implicit conversion)</span>
<span class="k">explicit</span> <span class="n">dispatch_queue</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">thread_cnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Destructor</span>
<span class="o">~</span><span class="n">dispatch_queue</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>
</div>
    </div>

    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/darcula.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>

    <script>
      hljs.initHighlightingOnLoad();
    </script>
  </div>
</body>

</html>
